## サーバーレス歴史

- 1970: タイムシェアリング方式
  - 計算資源の分配に応じた従量課金
- コンテナにより計算資源の分離と隔離が進む
- 計算機資源の抽象化と効率化

## めも

- **自由度と制約のトレードオフ**
- コールドスタート
  - AOT コンパイル (ネイティブバイナリ化) や遅延ロード も有効
- Cloudflare Workers
  - **V8 エンジン上の隔離されたコンテキストとして実行**
    - 独立した OS プロセスではない！
  - TLS ハンドシェイク中に関数コードを先行読み込み
- WASM
  - ブラウザ上で動作するバイナリフォーマット
  - 安全なサンドボックス内で実行可能
  - **高速起動・軽量な実行環境**という特徴から Cloudflare Workers で利用可能となっている
    - WASM コンテナがデプロイ可能
    - Docker, k8s でも
  - **CPU アーキテクチャ非依存の中間表現**
    - x86 でも ARM でも同じバイナリが動作する
  - **初期はブラウザを前提としていたため、ファイルシステムやネットワークといった『外界』とのやりとり標準 API がなかった**
    - **=> WASI (WebAssembly System Interface)**
    - OS やプラットフォーム非依存のシステムインターフェースを提供
  - **マイクロサービスや FaaS と特に相性がいい！**
    - CPU 集約型処理の WASM 化、エッジ上での機械学習推論
- サンドボックス
  - 一般的なコンテナのつらみ
    - OS の機能を使ってプロセスの権限やリソースを分離してた
    - が、**以前としてホストとカーネルを共有してるので、完全に信頼できないコードを動かすには不安**
  - microVM
    - AWS 2018, Firecracker
      - KVM ベースの仮想化基盤
        - Kernel-based Virtual Machine
      - ブートに必要な最小限のコンポーネントのみを搭載、省かれた linux カーネルを高速に起動可能
      - 従来の VM 並のセキュリティ境界と、コンテナ並みの軽量性
  - **gVisor**, Google
    - Linuxカーネルのサンドボックス
    - ユーザー空間カーネル
- Serverless GPU
- コンウェイの法則
  - 逆コンウェイの法則
    - **望ましいシステムアーキテクチャの構造に、組織やチーム編成を寄せていく**
    - Team Topologies
- 非同期処理
  - **サーバーの呪縛から解放されるサーバーレスの進化は非同期アーキテクチャにある**
- Human-in-the-Loop
  - Azure, AWS Step Functions などなど
  - 外部イベントが届くまで何時間でも (1 年まで) 待つことが可能
  - ユースケース
    - **確認コードの待機**
    - **電話番号認証等**
- ローカル開発
  - localstack
    - https://github.com/localstack/localstack
  - tflocal
    - https://github.com/localstack/terraform-local
- OpenFeature
  - https://openfeature.dev/
    - フィーチャーフラグマネジメントのオープンスタンダード
    - 一貫性のある、統一された API を提供する
  - Feature Flags as Code
- オブザーバビリティ
  - メトリクス・ログ・トレース
    - 三本柱
  - **イベント**
    - ユーザーの操作
    - システム内部で起きた出来事の記録
- OpenSearch Serlverless
- **Open Table Format**
- クロスクラウド
  - BigQuery Omni
    - S3 に対してクエリ可能
  - **プロトコル・インタフェースの標準化**
    - S3: 実質のデファクト、多くが互換 API を提供
    - **CNCF: CloudEvents**
